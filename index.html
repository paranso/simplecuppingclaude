<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Cupping Form</title>

    <!-- ReactÂ·Tailwind ë“± ê¸°ì¡´ ì˜ì¡´ì„±ë“¤ -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Android ë¸Œë¼ìš°ì €ì—ì„œ í¬ì»¤ìŠ¤ ì‹œ ìë™ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        html, body {
            overscroll-behavior-y: contain;
            overflow-anchor: none;
        }

        /* ì»¤ìŠ¤í…€ CSS ë³€ìˆ˜ ì •ì˜ */
        :root {
            --sage-green: #9CAF88;
            --forest-green: #6B8E5A;
            --warm-gray: #8B7355;
        }

        /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
        .gradient-bg {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        /* ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ íš¨ê³¼ */
        .glass {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        /* í˜¸ë²„ íš¨ê³¼ */
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.5);
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        .fade-in {
            animation: fadeIn 1s ease-in;
        }

        .slide-up {
            animation: slideUp 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ì»¤ìŠ¤í…€ ìŠ¬ë¼ì´ë” ìŠ¤íƒ€ì¼ */
        .slider {
            background: linear-gradient(to right, #e5e7eb 0%, var(--sage-green) 50%, var(--forest-green) 100%);
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--sage-green);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--sage-green);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        /* Tailwind ì»¤ìŠ¤í…€ ìƒ‰ìƒ */
        .text-sage-green { color: var(--sage-green); }
        .text-forest-green { color: var(--forest-green); }
        .bg-sage-green { background-color: var(--sage-green); }
        .bg-forest-green { background-color: var(--forest-green); }
        .border-sage-green { border-color: var(--sage-green); }
        .hover\:bg-sage-green:hover { background-color: var(--sage-green); }
        .hover\:bg-forest-green:hover { background-color: var(--forest-green); }
        .focus\:ring-sage-green:focus { 
            --tw-ring-color: var(--sage-green);
        }

        /* í¬ì»¤ìŠ¤ ìŠ¤í¬ë¡¤ ë°©ì§€ë¥¼ ìœ„í•œ ì¶”ê°€ CSS */
        .no-scroll-on-focus input:focus,
        .no-scroll-on-focus textarea:focus,
        .no-scroll-on-focus select:focus {
            scroll-behavior: auto;
        }

        /* Android ì „ìš© í¬ì»¤ìŠ¤ ë°©ì§€ */
        @media screen and (max-width: 768px) {
            input, textarea, select {
                font-size: 16px; /* iOS ì¤Œ ë°©ì§€ */
            }
            
            .no-scroll-on-focus {
                scroll-behavior: auto;
                overscroll-behavior: contain;
            }

            /* ì•ˆë“œë¡œì´ë“œì—ì„œ ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ ìŠ¤í¬ë¡¤ ì™„ì „ ë°©ì§€ */
            input:focus, textarea:focus {
                transform: translateZ(0);
                scroll-behavior: auto;
            }

            /* ìŠ¬ë¼ì´ë” ì¡°ì‘ ì‹œ ë‹¤ë¥¸ ìš”ì†Œì˜ í¬ì»¤ìŠ¤ í•´ì œ */
            input[type="range"]:active ~ *,
            input[type="range"]:focus ~ * {
                pointer-events: none;
            }
        }

        /* ê°•ë ¥í•œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        .prevent-scroll {
            overflow: hidden !important;
            position: fixed !important;
            width: 100% !important;
        }

        /* ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        input:focus, textarea:focus {
            scroll-margin: 0;
            scroll-snap-align: none;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Google Apps Script URL - ìµœì¢… ì—°ê²° ì™„ë£Œ!
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyu9ZJznYRFk8PR2GYIKJVnMlgwjENq_Nv_h7Kgtaa-5EtVQElkBpTd2NNObl7iaj21/exec';

        const SimpleCuppingForm = () => {
            // ìƒíƒœ ê´€ë¦¬
            const initialFormData = {
                roastingDate: '', cuppingDate: '', userId: '', coffeeName: '', dropTime: '', agtronNumber: ''
            };
            const initialScores = { aroma: 8, acidity: 8, sweetness: 8, body: 8, aftertaste: 8 };
            const initialCustomNotes = { ê½ƒ: '', ê³¼ì¼ë¥˜: '', í—ˆë¸Œ: '', ê²¬ê³¼ë¥˜: '', ìºëŸ¬ë©œ: '', ì´ˆì½œë¦¿: '', ë””í™íŠ¸: '' };

            const [formData, setFormData] = useState(initialFormData);
            const [scores, setScores] = useState(initialScores);
            const [selectedAromas, setSelectedAromas] = useState([]);
            const [expandedCategory, setExpandedCategory] = useState(null);
            const [notes, setNotes] = useState('');
            const [customNotes, setCustomNotes] = useState(initialCustomNotes);
            const [roastingNotes, setRoastingNotes] = useState('');

            const [isSubmitting, setIsSubmitting] = useState(false);
            const [statusMessage, setStatusMessage] = useState('');
            const [showSummary, setShowSummary] = useState(false);
            const [summaryData, setSummaryData] = useState(null);

            // ì•ˆë“œë¡œì´ë“œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ìœ„í•œ useEffect
            useEffect(() => {
                // í˜ì´ì§€ ë¡œë“œ ì‹œ í¬ì»¤ìŠ¤ ì œê±°
                if (document.activeElement && document.activeElement.blur) {
                    document.activeElement.blur();
                }
                
                // ì•ˆë“œë¡œì´ë“œì—ì„œ ìë™ ì¤Œ ë°©ì§€
                const viewport = document.querySelector('meta[name=viewport]');
                if (viewport) {
                    viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
                }

                // ìŠ¤í¬ë¡¤ ì•µì»¤ë§ ë°©ì§€
                if (CSS.supports('overflow-anchor', 'none')) {
                    document.body.style.overflowAnchor = 'none';
                }

                // ê°•ë ¥í•œ í¬ì»¤ìŠ¤ ì œê±° í•¨ìˆ˜
                const forcedBlur = () => {
                    if (document.activeElement && document.activeElement !== document.body) {
                        document.activeElement.blur();
                    }
                };

                // í„°ì¹˜/í´ë¦­ ì´ë²¤íŠ¸ì—ì„œ í¬ì»¤ìŠ¤ ì œê±°
                const handleInteraction = (e) => {
                    // ìŠ¬ë¼ì´ë”ë‚˜ ë²„íŠ¼ í´ë¦­ ì‹œ
                    if (e.target.type === 'range' || e.target.tagName === 'BUTTON') {
                        setTimeout(forcedBlur, 50);
                    }
                };

                // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë°©ì§€
                const preventScroll = (e) => {
                    // ì…ë ¥ í•„ë“œê°€ í¬ì»¤ìŠ¤ëœ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ìš”ì†Œ ì¡°ì‘ ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€
                    if (document.activeElement && 
                        (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA') &&
                        e.target !== document.activeElement) {
                        e.preventDefault();
                        forcedBlur();
                    }
                };

                // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                document.addEventListener('touchstart', handleInteraction, { passive: true });
                document.addEventListener('click', handleInteraction, { passive: true });
                document.addEventListener('touchmove', preventScroll, { passive: false });

                // cleanup
                return () => {
                    document.removeEventListener('touchstart', handleInteraction);
                    document.removeEventListener('click', handleInteraction);
                    document.removeEventListener('touchmove', preventScroll);
                };
            }, []);

            const aromaWheel = {
                'ê½ƒ': ['ì¥ë¯¸', 'ììŠ¤ë¯¼', 'ë¼ì¼ë½', 'ì»¤í”¼ë¸”ë¼ì¸', 'ì˜¤ë Œì§€ê½ƒ'],
                'ê³¼ì¼ë¥˜': ['ê°ê·¤ë¥˜(ì˜¤ë Œì§€/ë ˆëª¬)', 'ë² ë¦¬ë¥˜', 'ì—´ëŒ€ê³¼ì¼', 'ì‚¬ê³¼/ë°°', 'ìë‘/ì²´ë¦¬'],
                'í—ˆë¸Œ': ['ë¯¼íŠ¸', 'ìºëª¨ë§ˆì¼', 'ë¼ë²¤ë”', 'ë¡œì¦ˆë§ˆë¦¬', 'íƒ€ì„'],
                'ê²¬ê³¼ë¥˜': ['ì•„ëª¬ë“œ', 'í—¤ì´ì¦ë„›', 'í”¼ì¹¸', 'ë•…ì½©', 'í˜¸ë‘'],
                'ìºëŸ¬ë©œ': ['í‘ì„¤íƒ•', 'ë²„í„°ìŠ¤ì¹´ì¹˜', 'ë©”ì´í”Œì‹œëŸ½', 'í† í”¼', 'ìº”ë””'],
                'ì´ˆì½œë¦¿': ['ë‹¤í¬ì´ˆì½œë¦¿', 'ë°€í¬ì´ˆì½œë¦¿', 'ì½”ì½”ì•„', 'ì´ˆì½œë¦¿ì‹œëŸ½', 'ëª¨ì¹´'],
                'ë””í™íŠ¸': ['ì–¸ë”', 'ì˜¤ë²„', 'ë² ì´í¬ë“œ', 'ëª°ë””', 'ë©”íƒˆë¦­', 'ê³¼ë°œíš¨']
            };

            const scoreLabels = { aroma: 'í–¥', acidity: 'ì‚°ë¯¸', sweetness: 'ë‹¨ë§›', body: 'ë°”ë””ê°', aftertaste: 'í›„ë¯¸' };
            const scoreDescriptions = {
                aroma: 'Fragrance(ë¶„ì‡„í–¥) / Aroma(ìŠµì‹í–¥)', 
                acidity: 'ì‹ ë§›ì˜ ì •ë„ì™€ íŠ¹ì„±',
                sweetness: 'ìì—°ìŠ¤ëŸ¬ìš´ ë‹¨ë§›', 
                body: 'ì…ì•ˆì˜ ë¬´ê²Œê°/ì§ˆê°', 
                aftertaste: 'ê¸ì •ì  ë§›/í–¥ì˜ ì§€ì†ì„±'
            };

            // í•¸ë“¤ëŸ¬ í•¨ìˆ˜ë“¤
            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
                
                // ì…ë ¥ ì™„ë£Œ í›„ ì¼ì • ì‹œê°„ ë’¤ í¬ì»¤ìŠ¤ í•´ì œ (ì•ˆë“œë¡œì´ë“œ ëŒ€ì‘)
                setTimeout(() => {
                    if (e.target && e.target.blur) {
                        e.target.blur();
                    }
                }, 100);
            };

            const handleScoreChange = (category, value) => {
                setScores(prev => ({ ...prev, [category]: parseInt(value) }));
                
                // ì•ˆë“œë¡œì´ë“œì—ì„œ ìŠ¬ë¼ì´ë” ì¡°ì‘ í›„ ê°•ì œ í¬ì»¤ìŠ¤ í•´ì œ
                setTimeout(() => {
                    if (document.activeElement && document.activeElement.blur) {
                        document.activeElement.blur();
                    }
                    // ëª¨ë“  ì…ë ¥ í•„ë“œì˜ í¬ì»¤ìŠ¤ í•´ì œ
                    const inputs = document.querySelectorAll('input, textarea');
                    inputs.forEach(input => {
                        if (input.type !== 'range') {
                            input.blur();
                        }
                    });
                }, 10);
            };

            const handleCategoryClick = (category) => {
                // ì¹´í…Œê³ ë¦¬ í´ë¦­ ì‹œì—ë„ ëª¨ë“  ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ í•´ì œ
                document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(input => input.blur());
                
                setExpandedCategory(expandedCategory === category ? null : category);
                
                // ì¶”ê°€ í¬ì»¤ìŠ¤ í•´ì œ
                setTimeout(() => {
                    if (document.activeElement && document.activeElement !== document.body) {
                        document.activeElement.blur();
                    }
                }, 10);
            };

            const handleAromaSelectWithScroll = (aroma, e) => {
                e.preventDefault();
                e.stopPropagation();
                
                // ë¨¼ì € ëª¨ë“  ì…ë ¥ í•„ë“œì˜ í¬ì»¤ìŠ¤ í•´ì œ
                document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(input => input.blur());
                
                setSelectedAromas(prev =>
                    prev.includes(aroma) ? prev.filter(a => a !== aroma) : [...prev, aroma]
                );
                
                // ì•ˆë“œë¡œì´ë“œì—ì„œ ìŠ¤í¬ë¡¤ ë°©ì§€
                if (e.target && e.target.blur) {
                    setTimeout(() => e.target.blur(), 10);
                }
                
                // ì¶”ê°€ í¬ì»¤ìŠ¤ í•´ì œ
                setTimeout(() => {
                    if (document.activeElement && document.activeElement !== document.body) {
                        document.activeElement.blur();
                    }
                }, 50);
            };

            const handleCustomNotesChange = (category, value) => {
                setCustomNotes(prev => ({ ...prev, [category]: value }));
            };

            // ì¶”ì²œ ì‹œìŠ¤í…œ (15ë‹¨ê³„ ê¸°ì¤€)
            const getRecommendation = () => {
                let recommendations = [];
                if (scores.acidity > 10) recommendations.push("ì‚°ë¯¸ ê°•í•¨: ë¡œìŠ¤íŒ… ì˜¨ë„ ì•½ê°„ ìƒìŠ¹ ê³ ë ¤.");
                if (scores.body < 6) recommendations.push("ë°”ë””ê° ë¶€ì¡±: ë””ë²¨ë¡­ ì‹œê°„ ì¦ê°€ ê³ ë ¤.");
                if (scores.sweetness < 6) recommendations.push("ë‹¨ë§› ë¶€ì¡±: ì²« í¬ë™ í›„ ì‹œê°„ ì¦ê°€ ê³ ë ¤.");
                if (scores.aroma < 6) recommendations.push("í–¥ ë¶€ì¡±: ì „ê°œ ì‹œê°„ ì¡°ì • ê³ ë ¤.");
                if (scores.aftertaste < 6) recommendations.push("í›„ë¯¸ ë¶€ì¡±: ë§ˆë¬´ë¦¬ ì˜¨ë„ ì¡°ì • ê³ ë ¤.");
                return recommendations.length > 0 ? recommendations.join(' ') : "ê· í˜• ì¡íŒ í”„ë¡œíŒŒì¼ì…ë‹ˆë‹¤.";
            };

            // í–¥ë¯¸ ë°ì´í„°ë¥¼ ê¹”ë”í•˜ê²Œ í¬ë§·íŒ…í•˜ëŠ” í•¨ìˆ˜
            const formatAromaData = () => {
                let aromaData = '';
                let notesData = '';
                
                // ì„ íƒëœ í–¥ë¯¸ë¥¼ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë¶„ë¥˜
                const categorizedAromas = {};
                Object.keys(aromaWheel).forEach(category => {
                    const categoryAromas = selectedAromas.filter(aroma => 
                        aromaWheel[category].includes(aroma)
                    );
                    if (categoryAromas.length > 0) {
                        categorizedAromas[category] = categoryAromas;
                    }
                });
                
                // ì„ íƒëœ í–¥ë¯¸ í¬ë§·íŒ…
                Object.entries(categorizedAromas).forEach(([category, aromas]) => {
                    aromaData += `[${category}] ${aromas.join(', ')}\n`;
                });
                
                // ì¹´í…Œê³ ë¦¬ë³„ ë©”ëª¨ í¬ë§·íŒ…
                Object.entries(customNotes).forEach(([category, note]) => {
                    if (note.trim()) {
                        notesData += `[${category}] ${note.trim()}\n`;
                    }
                });
                
                return {
                    formattedAromas: aromaData.trim(),
                    formattedNotes: notesData.trim()
                };
            };

            // ë°ì´í„° ì €ì¥ í•¨ìˆ˜
            const handleSave = async () => {
                if (!APPS_SCRIPT_URL || APPS_SCRIPT_URL === 'ì—¬ê¸°ì—_ë³µì‚¬í•œ_Apps_Script_ì›¹_ì•±_URL_ë¶™ì—¬ë„£ê¸°') {
                    setStatusMessage('âš ï¸ Google Apps Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                    setShowSummary(false);
                    return;
                }
                if (isSubmitting) return;

                setIsSubmitting(true);
                setStatusMessage('ğŸ’¾ ì €ì¥ ì¤‘...');
                setShowSummary(false);

                const recommendation = getRecommendation();
                const { formattedAromas, formattedNotes } = formatAromaData();

                const dataToSend = {
                    roastingDate: formData.roastingDate,
                    cuppingDate: formData.cuppingDate,
                    userId: formData.userId,
                    coffeeName: formData.coffeeName,
                    dropTimeTemp: formData.dropTime,
                    agtron: formData.agtronNumber,
                    aromaScore: scores.aroma,
                    acidityScore: scores.acidity,
                    sweetnessScore: scores.sweetness,
                    bodyScore: scores.body,
                    aftertasteScore: scores.aftertaste,
                    detectedFlavors: formattedAromas,
                    detailedAromaNotes: formattedNotes,
                    additionalNotes: notes,
                    roastingNotes: roastingNotes,
                    roastingRecommendation: recommendation
                };

                try {
                    const response = await fetch(APPS_SCRIPT_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        body: JSON.stringify(dataToSend)
                    });

                    if (!response.ok) {
                        throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status} ${response.statusText}`);
                    }

                    const result = await response.json();

                    if (result.status === 'success') {
                        setStatusMessage('âœ… ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                        setSummaryData({
                            ...formData,
                            ...scores,
                            selectedAromas: selectedAromas,
                            notes: notes,
                            customNotes: customNotes,
                            roastingNotes: roastingNotes,
                            recommendation: recommendation
                        });
                        setShowSummary(true);
                    } else {
                        setStatusMessage('âŒ ì €ì¥ ì‹¤íŒ¨: ' + (result.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'));
                        setShowSummary(false);
                    }
                } catch (error) {
                    console.error('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    setStatusMessage(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`);
                    setShowSummary(false);
                } finally {
                    setIsSubmitting(false);
                }
            };

            // í¼ ì´ˆê¸°í™”
            const resetForm = () => {
                setFormData(initialFormData);
                setScores(initialScores);
                setSelectedAromas([]);
                setExpandedCategory(null);
                setNotes('');
                setCustomNotes(initialCustomNotes);
                setRoastingNotes('');
                setShowSummary(false);
                setStatusMessage('');
            };

            // ê²°ê³¼ ìš”ì•½ ì»´í¬ë„ŒíŠ¸
            const ResultSummary = ({ data }) => {
                if (!data) return null;

                return (
                    <div className="mt-8 glass rounded-2xl p-6 slide-up border-l-4 border-sage-green">
                        <h2 className="text-xl font-bold mb-4 text-sage-green flex items-center">
                            <span className="mr-2">ğŸ“‹</span>
                            ì €ì¥ëœ ê²°ê³¼ ìš”ì•½
                        </h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div className="space-y-2">
                                <p><strong className="text-forest-green">ë¡œìŠ¤íŒ… ë‚ ì§œ:</strong> {data.roastingDate}</p>
                                <p><strong className="text-forest-green">ì»¤í•‘ ë‚ ì§œ:</strong> {data.cuppingDate}</p>
                                <p><strong className="text-forest-green">ì´ë¦„/ID:</strong> {data.userId}</p>
                                <p><strong className="text-forest-green">ì»¤í”¼ëª…:</strong> {data.coffeeName}</p>
                                <p><strong className="text-forest-green">ë°°ì¶œì‹œê°„/ì˜¨ë„:</strong> {data.dropTime}</p>
                                <p><strong className="text-forest-green">Agtron#:</strong> {data.agtronNumber}</p>
                            </div>
                            
                            <div>
                                <h4 className="font-semibold text-forest-green mb-2">í‰ê°€ ì ìˆ˜ (15ë‹¨ê³„)</h4>
                                <div className="space-y-1">
                                    {Object.entries(scoreLabels).map(([key, label]) => (
                                        <div key={key} className="flex justify-between">
                                            <span>{label}:</span>
                                            <span className="font-semibold text-sage-green">{data[key]}/15</span>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                        
                        {data.selectedAromas && data.selectedAromas.length > 0 && (
                            <div className="mt-4 pt-4 border-t">
                                <h4 className="font-semibold text-forest-green mb-2">ê°ì§€ëœ í–¥ë¯¸:</h4>
                                <div className="flex flex-wrap gap-1">
                                    {data.selectedAromas.map(aroma => (
                                        <span key={aroma} className="px-2 py-1 bg-green-100 text-sage-green rounded-full text-xs">
                                            {aroma}
                                        </span>
                                    ))}
                                </div>
                            </div>
                        )}
                        
                        {(data.notes || data.roastingNotes) && (
                            <div className="mt-4 pt-4 border-t">
                                {data.notes && (
                                    <div className="mb-3">
                                        <h4 className="font-semibold text-forest-green mb-2">ğŸ“ ì¶”ê°€ ë©”ëª¨:</h4>
                                        <p className="text-sm text-gray-700 bg-gray-50 p-3 rounded-lg">{data.notes}</p>
                                    </div>
                                )}
                                {data.roastingNotes && (
                                    <div>
                                        <h4 className="font-semibold text-forest-green mb-2">ğŸ”¥ ë¡œìŠ¤íŒ… ë…¸íŠ¸:</h4>
                                        <p className="text-sm text-gray-700 bg-gray-50 p-3 rounded-lg">{data.roastingNotes}</p>
                                    </div>
                                )}
                            </div>
                        )}
                        
                        {data.recommendation && (
                            <div className="mt-4 pt-4 border-t bg-green-50 rounded-lg p-3">
                                <h4 className="font-semibold text-forest-green mb-1">ğŸ¯ ìë™ ì¶”ì²œ:</h4>
                                <p className="text-sm text-gray-700">{data.recommendation}</p>
                            </div>
                        )}
                        
                        <button
                            onClick={() => setShowSummary(false)}
                            className="mt-4 px-4 py-2 bg-sage-green text-white text-sm rounded-lg hover:bg-forest-green transition-colors"
                        >
                            ìš”ì•½ ë‹«ê¸°
                        </button>
                    </div>
                );
            };

            return (
                <div className="container mx-auto px-4 py-8 max-w-6xl">
                    
                    {/* í—¤ë” */}
                    <div className="glass rounded-2xl p-6 mb-8 fade-in card-hover">
                        <h1 className="text-2xl md:text-3xl font-bold text-gray-800 text-center">
                            Simple Cupping Form
                        </h1>
                    </div>

                    {/* ê¸°ë³¸ ì •ë³´ */}
                    <div className="glass rounded-2xl p-6 mb-6 slide-up card-hover no-scroll-on-focus" style={{animationDelay: '0.2s'}}>
                        <div className="flex items-center mb-6">
                            <div className="w-10 h-10 bg-sage-green rounded-xl flex items-center justify-center mr-3">
                                <span className="text-white text-lg">ğŸ“‹</span>
                            </div>
                            <h2 className="text-xl font-semibold text-gray-800">ê¸°ë³¸ ì •ë³´</h2>
                        </div>
                        
                        <div className="space-y-4">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">ë¡œìŠ¤íŒ… ë‚ ì§œ</label>
                                    <input 
                                        type="date" 
                                        name="roastingDate"
                                        value={formData.roastingDate}
                                        onChange={handleInputChange}
                                        className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">ì»¤í•‘ ë‚ ì§œ</label>
                                    <input 
                                        type="date"
                                        name="cuppingDate"
                                        value={formData.cuppingDate}
                                        onChange={handleInputChange}
                                        className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                    />
                                </div>
                            </div>
                            
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">ì´ë¦„ or ID</label>
                                <input 
                                    type="text"
                                    name="userId"
                                    value={formData.userId}
                                    onChange={handleInputChange}
                                    placeholder="ì´ë¦„ ë˜ëŠ” IDë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                                    autoComplete="off"
                                    className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                />
                            </div>
                            
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">ì»¤í”¼ ì •ë³´</label>
                                <input 
                                    type="text"
                                    name="coffeeName"
                                    value={formData.coffeeName}
                                    onChange={handleInputChange}
                                    placeholder="ì»¤í”¼ì´ë¦„, ë†ì¥ëª…, í”„ë¡œì„¸ì‹± ë“±"
                                    className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                />
                            </div>
                            
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">ë°°ì¶œì‹œê°„ê³¼ ì˜¨ë„</label>
                                    <input 
                                        type="text"
                                        name="dropTime"
                                        value={formData.dropTime}
                                        onChange={handleInputChange}
                                        placeholder="ì˜ˆ: 12:30 / 204Â°C"
                                        className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Agtron#</label>
                                    <input 
                                        type="text"
                                        name="agtronNumber"
                                        value={formData.agtronNumber}
                                        onChange={handleInputChange}
                                        placeholder="ì˜ˆ: 65"
                                        className="w-full p-3 bg-white/50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* í‰ê°€ í•­ëª© (15ë‹¨ê³„) */}
                    <div className="glass rounded-2xl p-6 mt-6 slide-up card-hover" style={{animationDelay: '0.6s'}}>
                        <div className="flex items-center mb-6">
                            <div className="w-10 h-10 bg-sage-green rounded-xl flex items-center justify-center mr-3">
                                <span className="text-white text-lg">â­</span>
                            </div>
                            <h2 className="text-xl font-semibold text-gray-800">í‰ê°€ í•­ëª© (15ë‹¨ê³„)</h2>
                        </div>
                        
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            {Object.entries(scores).map(([category, value]) => (
                                <div key={category} className="space-y-3">
                                    <div className="flex justify-between items-center">
                                        <label className="text-lg font-medium text-gray-800">
                                            {scoreLabels[category]}
                                        </label>
                                        <span className="text-2xl font-bold text-sage-green">{value}</span>
                                    </div>
                                    <p className="text-sm text-gray-600 mb-3">{scoreDescriptions[category]}</p>
                                    <input 
                                        type="range" 
                                        min="1" 
                                        max="15" 
                                        value={value} 
                                        onChange={(e) => handleScoreChange(category, e.target.value)}
                                        onTouchStart={(e) => {
                                            // í„°ì¹˜ ì‹œì‘í•  ë•Œ ëª¨ë“  ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ í•´ì œ
                                            document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(input => input.blur());
                                        }}
                                        onTouchEnd={(e) => {
                                            // í„°ì¹˜ ëë‚  ë•Œ ìŠ¬ë¼ì´ë” ìì²´ë„ í¬ì»¤ìŠ¤ í•´ì œ
                                            setTimeout(() => e.target.blur(), 50);
                                        }}
                                        onMouseDown={(e) => {
                                            // ë§ˆìš°ìŠ¤ í´ë¦­ ì‹œì—ë„ ë™ì¼í•˜ê²Œ ì²˜ë¦¬
                                            document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(input => input.blur());
                                        }}
                                        className="w-full h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"
                                    />
                                    <div className="flex justify-between text-xs text-gray-600">
                                        <span>1 (ë§¤ìš° ì•½í•¨)</span>
                                        <span>8 (ë³´í†µ)</span>
                                        <span>15 (ë§¤ìš° ê°•í•¨)</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* í–¥ë¯¸ íœ  */}
                    <div className="glass rounded-2xl p-6 mt-6 slide-up card-hover" style={{animationDelay: '0.8s'}}>
                        <div className="flex items-center mb-6">
                            <div className="w-10 h-10 bg-forest-green rounded-xl flex items-center justify-center mr-3">
                                <span className="text-white text-lg">ğŸŒ¸</span>
                            </div>
                            <h2 className="text-xl font-semibold text-gray-800">í–¥ë¯¸ íŠ¹ì„± (Aroma Wheel)</h2>
                        </div>
                        
                        <div className="space-y-3">
                            {Object.entries(aromaWheel).map(([category, aromas]) => (
                                <div key={category} className="border border-gray-200 rounded-xl overflow-hidden">
                                    <button 
                                        onClick={() => handleCategoryClick(category)}
                                        className="w-full text-left p-4 hover:bg-gray-50 focus:outline-none transition-colors duration-200 flex justify-between items-center"
                                    >
                                        <span className="font-medium text-gray-800">{category}</span>
                                        <span className={`transform transition-transform duration-200 ${expandedCategory === category ? 'rotate-180' : ''}`}>
                                            â–¼
                                        </span>
                                    </button>
                                    
                                    {expandedCategory === category && (
                                        <div className="p-4 bg-gray-50 border-t">
                                            <div className="flex flex-wrap gap-2 mb-4">
                                                {aromas.map(aroma => (
                                                    <button 
                                                        key={aroma}
                                                        onClick={(e) => handleAromaSelectWithScroll(aroma, e)}
                                                        className={`px-3 py-2 rounded-full text-sm transition-all duration-300 ${
                                                            selectedAromas.includes(aroma) 
                                                                ? 'bg-sage-green text-white shadow-md' 
                                                                : 'bg-white text-gray-700 border border-gray-300 hover:bg-sage-green hover:text-white'
                                                        }`}
                                                    >
                                                        {aroma}
                                                    </button>
                                                ))}
                                            </div>
                                            <textarea 
                                                value={customNotes[category]}
                                                onChange={(e) => handleCustomNotesChange(category, e.target.value)}
                                                onBlur={(e) => {
                                                    // í…ìŠ¤íŠ¸ ì˜ì—­ì—ì„œ í¬ì»¤ìŠ¤ í•´ì œë  ë•Œ ì¶”ê°€ ì²˜ë¦¬
                                                    setTimeout(() => e.target.blur(), 50);
                                                }}
                                                placeholder={`${category} ê´€ë ¨ ìƒì„¸ ë…¸íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”...`}
                                                className="w-full p-3 border border-gray-200 rounded-lg h-20 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                                            />
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* ì„ íƒëœ í–¥ë¯¸ í‘œì‹œ */}
                    {selectedAromas.length > 0 && (
                        <div className="glass rounded-2xl p-6 mt-6 slide-up card-hover border-l-4 border-sage-green">
                            <h3 className="text-lg font-semibold mb-4 text-gray-800 flex items-center">
                                <span className="mr-2">ğŸ¯</span>
                                ê°ì§€ëœ ì£¼ìš” í–¥ë¯¸ ({selectedAromas.length}ê°œ)
                            </h3>
                            <div className="flex flex-wrap gap-2">
                                {selectedAromas.map(aroma => (
                                    <span 
                                        key={aroma} 
                                        className="px-3 py-2 bg-green-100 text-sage-green rounded-full text-sm font-medium border border-green-200"
                                    >
                                        {aroma}
                                    </span>
                                ))}
                            </div>
                        </div>
                    )}

                    {/* ë©”ëª¨ ì„¹ì…˜ */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                        <div className="glass rounded-2xl p-6 slide-up card-hover" style={{animationDelay: '1s'}}>
                            <div className="flex items-center mb-4">
                                <div className="w-8 h-8 bg-sage-green rounded-lg flex items-center justify-center mr-3">
                                    <span className="text-white text-sm">ğŸ“</span>
                                </div>
                                <h2 className="text-lg font-semibold text-gray-800">ì¶”ê°€ ë©”ëª¨</h2>
                            </div>
                            <textarea 
                                value={notes}
                                onChange={(e) => setNotes(e.target.value)}
                                onBlur={(e) => {
                                    // í…ìŠ¤íŠ¸ ì˜ì—­ì—ì„œ í¬ì»¤ìŠ¤ í•´ì œë  ë•Œ ì¶”ê°€ ì²˜ë¦¬
                                    setTimeout(() => e.target.blur(), 50);
                                }}
                                placeholder="ì „ì²´ì ì¸ ì¸ìƒ, ì§ˆê°, ë°¸ëŸ°ìŠ¤ ë“±ì„ ììœ ë¡­ê²Œ ê¸°ë¡í•´ì£¼ì„¸ìš”..."
                                className="w-full h-32 p-3 border border-gray-200 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                            />
                        </div>

                        <div className="glass rounded-2xl p-6 slide-up card-hover" style={{animationDelay: '1.2s'}}>
                            <div className="flex items-center mb-4">
                                <div className="w-8 h-8 bg-forest-green rounded-lg flex items-center justify-center mr-3">
                                    <span className="text-white text-sm">ğŸ”¥</span>
                                </div>
                                <h2 className="text-lg font-semibold text-gray-800">ë¡œìŠ¤íŒ… ë…¸íŠ¸</h2>
                            </div>
                            <textarea 
                                value={roastingNotes}
                                onChange={(e) => setRoastingNotes(e.target.value)}
                                onBlur={(e) => {
                                    // í…ìŠ¤íŠ¸ ì˜ì—­ì—ì„œ í¬ì»¤ìŠ¤ í•´ì œë  ë•Œ ì¶”ê°€ ì²˜ë¦¬
                                    setTimeout(() => e.target.blur(), 50);
                                }}
                                placeholder="ë¡œìŠ¤íŒ… í”„ë¡œíŒŒì¼, íŠ¹ì´ì‚¬í•­, ê°œì„  ë°©í–¥ ë“±ì„ ê¸°ë¡í•´ì£¼ì„¸ìš”..."
                                className="w-full h-32 p-3 border border-gray-200 rounded-lg text-sm resize-none focus:outline-none focus:ring-2 focus:ring-sage-green transition-all duration-300"
                            />
                        </div>
                    </div>



                    {/* ì €ì¥ ë²„íŠ¼ ë° ìƒíƒœ */}
                    <div className="mt-8 text-center slide-up" style={{animationDelay: '1.6s'}}>
                        <div className="flex flex-col sm:flex-row gap-4 justify-center items-center">
                            <button
                                onClick={handleSave}
                                disabled={isSubmitting}
                                className={`px-8 py-4 font-semibold rounded-2xl shadow-lg transition-all duration-300 transform ${
                                    isSubmitting 
                                        ? 'bg-gray-400 cursor-not-allowed' 
                                        : 'bg-white text-gray-800 border border-gray-200 hover:bg-gray-100 hover:scale-105'
                                }`}
                            >
                                {isSubmitting ? (
                                    <span className="flex items-center">
                                        <span className="animate-spin mr-2">â³</span>
                                        ì €ì¥ ì¤‘...
                                    </span>
                                ) : (
                                    <span className="flex items-center">
                                        <span className="mr-2">ğŸ’¾</span>
                                        ì»¤í•‘ ë°ì´í„° ì €ì¥
                                    </span>
                                )}
                            </button>
                            
                            <button
                                onClick={resetForm}
                                className="px-6 py-3 bg-gray-500 text-white font-medium rounded-xl hover:bg-gray-600 transition-colors duration-300"
                            >
                                ğŸ”„ í¼ ì´ˆê¸°í™”
                            </button>
                        </div>
                        
                        {statusMessage && (
                            <div className={`mt-4 p-3 rounded-lg text-sm ${
                                statusMessage.includes('ì„±ê³µ') 
                                    ? 'bg-green-100 text-green-700 border border-green-200' 
                                    : statusMessage.includes('ì˜¤ë¥˜') || statusMessage.includes('ì‹¤íŒ¨')
                                    ? 'bg-red-100 text-red-700 border border-red-200'
                                    : 'bg-blue-100 text-blue-700 border border-blue-200'
                            }`}>
                                {statusMessage}
                            </div>
                        )}
                    </div>

                    {/* ê²°ê³¼ ìš”ì•½ */}
                    {showSummary && <ResultSummary data={summaryData} />}

                </div>
            );
        };

        // React ì•± ë Œë”ë§
        const rootElement = document.getElementById('root');
        if (rootElement) {
            const root = ReactDOM.createRoot(rootElement);
            root.render(<SimpleCuppingForm />);
        } else {
            console.error("Root element with id 'root' not found.");
        }
    </script>
</body>
</html>
